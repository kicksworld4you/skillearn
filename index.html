<!DOCTYPE html>
<html lang="en">  
<head>  
    <meta charset="UTF-8">  
    <meta name="viewport" content="width=device-width, initial-scale=1.0">  
    <title>SkillLearn | User Dashboard</title>  
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">  

    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>  
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>  
    
    <script>  
      const firebaseConfig = {  
        apiKey: "AIzaSyByySH5u93ltrhej8W1PB0MsW5eVicFrw8",  
        authDomain: "skillearn-3af71.firebaseapp.com",  
        projectId: "skillearn-3af71",  
        storageBucket: "skillearn-3af71.firebasestorage.app",  
        messagingSenderId: "472123785889",  
        appId: "1:472123785889:web:578122950a7acaea4466e0"  
      };  
      firebase.initializeApp(firebaseConfig);

      // Check User State (Main Logic)
      firebase.auth().onAuthStateChanged((user) => {
          const landing = document.getElementById('landing-page');
          const dash = document.getElementById('dashboard-wrapper');
          
          if (user) {
              console.log("User Logged In:", user.email);
              landing.style.display = 'none';
              dash.style.display = 'flex';
              document.getElementById('user-email-display').innerText = user.email;
              showTab('dash-home'); // Default dashboard view
          } else {
              console.log("User Logged Out");
              landing.style.display = 'block';
              dash.style.display = 'none';
          }
      });

      // Sidebar Navigation
      function showTab(tabId) {
          const tabs = document.querySelectorAll('.tab-content');
          tabs.forEach(tab => tab.style.display = 'none');
          document.getElementById(tabId).style.display = 'block';
          
          const titleMap = {'dash-home': 'Overview', 'dash-courses': 'Marketplace', 'dash-affiliate': 'Affiliate'};
          document.getElementById('current-tab-title').innerText = titleMap[tabId];
      }

      function toggleSidebar() {
          document.getElementById('mySidebar').classList.toggle('active');
          document.getElementById('sidebar-overlay').style.display = 
          document.getElementById('mySidebar').classList.contains('active') ? 'block' : 'none';
      }

      function openLogin() { document.getElementById('loginModal').style.display = 'flex'; }
      function openSignup() { document.getElementById('signupModal').style.display = 'flex'; }
      function closeModal() { document.querySelectorAll('.modal').forEach(m => m.style.display = 'none'); }
      function logout() { firebase.auth().signOut(); }
      
      // Payment Modal Logic
      function openPayment(course, price) {
          document.getElementById('pay-course-name').innerText = "Pay " + price + " for " + course;
          document.getElementById('paymentModal').style.display = 'flex';
      }
      function confirmPayment() {
          const utr = document.getElementById('utrNumber').value;
          if(utr.length < 6) { alert("Invalid UTR!"); return; }
          document.getElementById('paymentMessage').style.display = 'block';
      }
    </script>

    <style>
        body { font-family: sans-serif; margin: 0; padding: 0; }
        /* Landing Page */
        #landing-page { text-align: center; padding: 50px; }
        .btn-primary { background: #f39c12; color: white; padding: 12px 25px; border: none; border-radius: 5px; cursor: pointer; font-weight: bold; }
        
        /* Dashboard Layout */
        #dashboard-wrapper { display: none; height: 100vh; overflow: hidden; background: #f4f7f6; }
        .sidebar { width: 260px; background: #1a252f; color: white; display: flex; flex-direction: column; transition: 0.3s; z-index: 2000; }
        .sidebar-header { padding: 20px; font-size: 22px; color: #f39c12; border-bottom: 1px solid #2c3e50; }
        .sidebar-link { padding: 15px 25px; cursor: pointer; color: #adb5bd; border-left: 4px solid transparent; }
        .sidebar-link:hover { background: #2c3e50; color: white; border-left: 4px solid #f39c12; }
        .main-view { flex: 1; display: flex; flex-direction: column; overflow-y: auto; }
        .top-bar { padding: 15px; background: white; display: flex; justify-content: space-between; border-bottom: 1px solid #ddd; }

        /* Responsive */
        @media (max-width: 768px) {
            .sidebar { position: fixed; left: -260px; height: 100%; top: 0; }
            .sidebar.active { left: 0; }
        }

        /* Modals */
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 3000; justify-content: center; align-items: center; }
        .modal-content { background: white; padding: 30px; border-radius: 10px; width: 300px; text-align: center; }
        .modal-content input { width: 100%; padding: 10px; margin: 10px 0; border: 1px solid #ddd; border-radius: 5px; box-sizing: border-box; }
        .tab-content { padding: 20px; display: none; }
    </style>
</head>

<body>

<div id="landing-page">
    <h1>Welcome to SkillLearn</h1>
    <button onclick="openLogin()" class="btn-primary">Login</button>
    <button onclick="openSignup()" style="margin-left:10px; padding: 12px; cursor:pointer;">Sign Up</button>
</div>

<div id="dashboard-wrapper">
    <div id="sidebar-overlay" onclick="toggleSidebar()" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.5); z-index:1900;"></div>
    <aside class="sidebar" id="mySidebar">
        <div class="sidebar-header">SkillLearn</div>
        <div class="sidebar-link" onclick="showTab('dash-home')">Dashboard</div>
        <div class="sidebar-link" onclick="showTab('dash-courses')">Courses</div>
        <div class="sidebar-link" onclick="showTab('dash-affiliate')">Affiliate</div>
        <div class="sidebar-link" onclick="logout()" style="margin-top:auto; color:red;">Logout</div>
    </aside>

    <main class="main-view">
        <header class="top-bar">
            <button onclick="toggleSidebar()"><i class="fas fa-bars"></i></button>
            <h3 id="current-tab-title">Overview</h3>
            <span id="user-email-display"></span>
        </header>

        <div id="dash-home" class="tab-content">
            <h2>Welcome Back!</h2>
            <p>Aapka account active hai.</p>
        </div>

        <div id="dash-courses" class="tab-content">
            <h3>Available Courses</h3>
            <button onclick="openPayment('Video Editing', '₹1299')">Buy Video Editing - ₹1299</button>
        </div>

        <div id="dash-affiliate" class="tab-content">
            <h3>Affiliate Link</h3>
            <input type="text" readonly value="https://skilllearn.in/ref=user" style="width:100%;">
        </div>
    </main>
</div>

<div id="loginModal" class="modal">
    <div class="modal-content">
        <h3>Login</h3>
        <input type="email" id="lEmail" placeholder="Email">
        <input type="password" id="lPass" placeholder="Password">
        <button onclick="handleLogin()" class="btn-primary" style="width:100%">Login Now</button>
        <p onclick="closeModal()" style="cursor:pointer; color:red;">Close</p>
    </div>
</div>

<div id="signupModal" class="modal">
    <div class="modal-content">
        <h3>Sign Up</h3>
        <input type="email" id="sEmail" placeholder="Email">
        <input type="password" id="sPass" placeholder="Password">
        <button onclick="handleSignup()" class="btn-primary" style="width:100%">Create Account</button>
        <p onclick="closeModal()" style="cursor:pointer; color:red;">Close</p>
    </div>
</div>

<div id="paymentModal" class="modal">
    <div class="modal-content">
        <h3 id="pay-course-name">Payment</h3>
        <p>Pay to: <b>9321377791@ybl</b></p>
        <input type="text" id="utrNumber" placeholder="Enter UTR Number">
        <button onclick="confirmPayment()" class="btn-primary">Confirm Payment</button>
        <p id="paymentMessage" style="display:none; color:blue;">Please wait 15 minutes for verification.</p>
        <p onclick="document.getElementById('paymentModal').style.display='none'" style="cursor:pointer;">Cancel</p>
    </div>
</div>

<script>
    function handleLogin() {
        const e = document.getElementById('lEmail').value;
        const p = document.getElementById('lPass').value;
        firebase.auth().signInWithEmailAndPassword(e, p)
        .then(() => closeModal())
        .catch(err => alert("Login Failed: " + err.message));
    }
    function handleSignup() {
        const e = document.getElementById('sEmail').value;
        const p = document.getElementById('sPass').value;
        firebase.auth().createUserWithEmailAndPassword(e, p)
        .then(() => closeModal())
        .catch(err => alert("Signup Failed: " + err.message));
    }
</script>

</body>  
</html>

